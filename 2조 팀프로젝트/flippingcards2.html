<!DOCTYPE html>
<html lang="ko">
   <head>
      <meta charset="UTF-8" />
      <title>ì¹´ë“œ ë’¤ì§‘ê¸° ê²Œì„</title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="stylesheet" href="./CSS/flippingcards2.css" />
      <link rel="stylesheet" href="./CSS/headerfooter.css" />
      <link rel="stylesheet" href="./CSS/common.css" />
   </head>
   <body>
      <header>
         <nav>
            <div class="header__right">
               <i class="fa-brands fa-bluetooth"></i>
               <i class="fa-solid fa-wifi"></i>
               <i class="fa-solid fa-signal"></i>
               <i class="fa-solid fa-battery-three-quarters"></i>
            </div>
            <div class="header__left">
               <a href="index.html"><span>AWS</span></a>
               <span id="time">5:03 </span>
               <span>2ì¡°</span>
            </div>
            <div class="header-container">
               <ul class="header__menu">
                  <li><a href="rock.html">ê°€ìœ„ ë°”ìœ„ ë³´</a></li>
                  <li><a href="numberGame.html">ìˆ«ì ë§ì¶”ê¸°</a></li>
                  <li><a href="flippingcards2.html">ì¹´ë“œ ë’¤ì§‘ê¸°</a></li>
                  <li>
                     <a href="#foot" id="team">íŒ€ì› ì†Œê°œ</a>
                     <ul class="submenu">
                        <li>ë°•ì¸ë•</li>
                        <li>ì „ì˜ˆì€</li>
                        <li>ì „ì¤€ëª¨</li>
                        <li>í™©ë¯¼ì˜</li>
                     </ul>
                  </li>
               </ul>
            </div>
         </nav>
      </header>
      <h1 style="margin-top: 15px">ğŸƒ ì¹´ë“œ ë’¤ì§‘ê¸° ê²Œì„</h1>

      <div class="controls">
         <label for="difficulty">ë‚œì´ë„:</label>
         <select id="difficulty">
            <option value="easy">ì‰¬ì›€</option>
            <option value="normal" selected>ë³´í†µ</option>
            <option value="hard">ì–´ë ¤ì›€</option>
         </select>
         <button id="resetBtn">ë‹¤ì‹œ ì‹œì‘</button>
         <label><input type="checkbox" id="toggleTimer" checked /> ì œí•œ ì‹œê°„ ì‚¬ìš©</label>
         <div id="timer">ë‚¨ì€ ì‹œê°„: 60ì´ˆ</div>
         <div id="score">ì ìˆ˜: 0</div>
         <div id="attempts">ì‹œë„ íšŸìˆ˜: 0</div>
      </div>

      <div id="game"></div>

      <div id="message"></div>

      <h2>ğŸ† ë­í‚¹</h2>
      <ol id="rankingList" style="margin-bottom: 10px"></ol>

      <footer id="foot">
         <div class="info" style="text-align: left;">
            <ul class="name">
               <li>
                  ë°•ì¸ë•ì˜ ì·¨ë¯¸
                  <ul>
                     <li>ìˆ˜ì˜</li>
                     <li>ë“±ì‚°</li>
                  </ul>
               </li>
               <li>
                  ì „ì˜ˆì€ì˜ ì·¨ë¯¸
                  <ul>
                     <li>K ë¦¬ê·¸ ê²½ê¸° ê´€ëŒ</li>
                     <li>F1 ê²½ê¸° ê´€ëŒ</li>
                  </ul>
               </li>
               <li>
                  ì „ì¤€ëª¨ì˜ ì·¨ë¯¸
                  <ul>
                     <li>ë†êµ¬</li>
                     <li>ì¼ë ‰</li>
                  </ul>
               </li>
               <li>
                  í™©ë¯¼ì˜ì˜ ì·¨ë¯¸
                  <ul>
                     <li>ê·¸ë¦¼</li>
                     <li>ìœ íŠœë¸Œ ì‹œì²­</li>
                  </ul>
               </li>
            </ul>
         </div>
         <p>&copy; 2025 ì¹´ë“œ ê²Œì„</p>
      </footer>

      <script>
         const game = document.getElementById('game')
         const scoreDisplay = document.getElementById('score')
         const attemptsDisplay = document.getElementById('attempts')
         const timerDisplay = document.getElementById('timer')
         const messageDisplay = document.getElementById('message')
         const rankingList = document.getElementById('rankingList')
         const resetBtn = document.getElementById('resetBtn')
         const difficultySelect = document.getElementById('difficulty')
         const toggleTimer = document.getElementById('toggleTimer')

         const emojis = ['ğŸ', 'ğŸŒ', 'ğŸ‡', 'ğŸ“', 'ğŸ‰', 'ğŸ', 'ğŸ¥', 'ğŸ¥¥', 'ğŸ’', 'ğŸ‘']

         const difficultySettings = {
            easy: { pairs: 4, time: 60, bg: 'var(--bg-easy)' },
            normal: { pairs: 6, time: 60, bg: 'var(--bg-normal)' },
            hard: { pairs: 8, time: 45, bg: 'var(--bg-hard)' },
         }

         let cardsArray = []
         let flippedCards = []
         let matched = 0
         let attempts = 0
         let score = 0
         let timeLeft = 60
         let timer = null

         const sounds = {
            match: new Audio('https://cdn.pixabay.com/audio/2022/03/15/audio_45c3c9d9ac.mp3'),
            mismatch: new Audio('https://cdn.pixabay.com/audio/2022/03/15/audio_6df56c1e5b.mp3'),
            win: new Audio('https://cdn.pixabay.com/audio/2022/03/15/audio_e8e65b8ebd.mp3'),
            lose: new Audio('https://cdn.pixabay.com/audio/2022/03/15/audio_ba3479c297.mp3'),
         }

         function shuffle(array) {
            return array.sort(() => Math.random() - 0.5)
         }

         function updateScore() {
            scoreDisplay.textContent = `ì ìˆ˜: ${score}`
         }

         function updateAttempts() {
            attemptsDisplay.textContent = `ì‹œë„ íšŸìˆ˜: ${attempts}`
         }

         function startTimer() {
            stopTimer()
            timerDisplay.textContent = `ë‚¨ì€ ì‹œê°„: ${timeLeft}ì´ˆ`
            if (!toggleTimer.checked) return
            timer = setInterval(() => {
               timeLeft--
               timerDisplay.textContent = `ë‚¨ì€ ì‹œê°„: ${timeLeft}ì´ˆ`
               if (timeLeft <= 0) {
                  clearInterval(timer)
                  sounds.lose.play()
                  messageDisplay.textContent = 'â° ì‹œê°„ ì´ˆê³¼! ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”'
               }
            }, 1000)
         }

         function stopTimer() {
            clearInterval(timer)
         }

         function getRankings() {
            return JSON.parse(localStorage.getItem('rankings') || '[]')
         }

         function saveRanking(name, score) {
            const rankings = getRankings()
            rankings.push({ name, score })
            rankings.sort((a, b) => b.score - a.score)
            localStorage.setItem('rankings', JSON.stringify(rankings.slice(0, 5)))
         }

         function updateRankingUI() {
            const rankings = getRankings()
            rankingList.innerHTML = rankings.map((r) => `<li>${r.name}: ${r.score}ì </li>`).join('')
         }

         function createCard(emoji) {
            const card = document.createElement('div')
            card.className = 'card hidden'

            const inner = document.createElement('div')
            inner.className = 'inner'

            const front = document.createElement('div')
            front.className = 'front'
            front.textContent = emoji

            const back = document.createElement('div')
            back.className = 'back'
            back.textContent = 'â“'

            inner.appendChild(front)
            inner.appendChild(back)
            card.appendChild(inner)

            card.addEventListener('click', () => handleCardClick(card))
            return card
         }

         function handleCardClick(card) {
            if (!card.classList.contains('hidden') || flippedCards.length >= 2) return
            card.classList.remove('hidden')
            flippedCards.push(card)

            if (flippedCards.length === 2) {
               attempts++
               updateAttempts()

               const [c1, c2] = flippedCards
               const e1 = c1.querySelector('.front').textContent
               const e2 = c2.querySelector('.front').textContent

               if (e1 === e2) {
                  sounds.match.play()
                  matched += 2
                  score += 100
                  updateScore()
                  flippedCards = []

                  if (matched === cardsArray.length) {
                     stopTimer()
                     sounds.win.play()
                     messageDisplay.textContent = 'ğŸ‰ ëª¨ë‘ ë§ì·„ìŠµë‹ˆë‹¤! ì¶•í•˜í•©ë‹ˆë‹¤!'
                     setTimeout(() => {
                        const name = prompt('ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”:')
                        if (name) {
                           saveRanking(name, score)
                           updateRankingUI()
                        }
                     }, 300)
                  }
               } else {
                  sounds.mismatch.play()
                  score = Math.max(0, score - 20)
                  updateScore()
                  setTimeout(() => {
                     c1.classList.add('hidden')
                     c2.classList.add('hidden')
                     flippedCards = []
                  }, 700)
               }
            }
         }

         function resetGame() {
            const difficulty = difficultySelect.value
            const settings = difficultySettings[difficulty]
            document.body.style.backgroundColor = settings.bg

            const selectedEmojis = shuffle([...emojis].slice(0, settings.pairs))
            cardsArray = shuffle(selectedEmojis.flatMap((e) => [e, e]))

            game.innerHTML = ''
            cardsArray.forEach((emoji) => game.appendChild(createCard(emoji)))

            flippedCards = []
            matched = 0
            attempts = 0
            score = 0
            timeLeft = settings.time
            updateScore()
            updateAttempts()
            messageDisplay.textContent = ''
            startTimer()
            updateRankingUI()
         }

         resetBtn.addEventListener('click', resetGame)
         difficultySelect.addEventListener('change', resetGame)
         resetGame()

         //
         const time = document.querySelector('#time')
         const clock = new Date()
         const text = `${clock.getHours()}:${clock.getMinutes()}`

         time.textContent = `${text}`
      </script>
   </body>
</html>
